<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" type="image/png" href="/images/favicon.png">

<title>Meilisearch vs Elasticsearch | KT</title>

<meta name="description" content="My personal blog. Interesting in Ruby, Rails and more." />
<!-- Begin Bridgetown SEO tag v5.0.0 -->
<title>Meilisearch vs Elasticsearch | KT</title>
<meta property="og:title" content="Meilisearch vs Elasticsearch" />
<meta name="author" content="Karn" />
<meta property="og:locale" content="th" />
<meta name="description" content="ถ้าจะกล่าวถึง Full-Text Search ก็น่าจะพอได้ยิน Elasticsearc กันมาบ้าง และจากบทความHow to add Search in Rails using Meilisearch ทำให้เราได้เจอกับ Meilisearch ซึ่งเป็นเครื่องมือที่ดีตัวหนึ่งในการทำ Full-Text Search เพียงแต่อาจจะต้องรอให้เติมโตจนพร้อมกว่านี้ คาดว่าอาจจะทำงานได้เทียบเคียงกับ Elasticsearch เลยทีเดียว" />
<meta property="og:description" content="ถ้าจะกล่าวถึง Full-Text Search ก็น่าจะพอได้ยิน Elasticsearc กันมาบ้าง และจากบทความHow to add Search in Rails using Meilisearch ทำให้เราได้เจอกับ Meilisearch ซึ่งเป็นเครื่องมือที่ดีตัวหนึ่งในการทำ Full-Text Search เพียงแต่อาจจะต้องรอให้เติมโตจนพร้อมกว่านี้ คาดว่าอาจจะทำงานได้เทียบเคียงกับ Elasticsearch เลยทีเดียว" />
<meta property="og:site_name" content="KT" />
<meta property="og:image" content="/images/posts/2022/meilisearch-vs-elasticsearch/cover.png" />
<meta property="og:image:height" content="630" />
<meta property="og:image:width" content="1200" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-20T12:30:00+07:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/images/posts/2022/meilisearch-vs-elasticsearch/cover.png" />
<meta property="twitter:title" content="Meilisearch vs Elasticsearch" />
<!-- End Bridgetown SEO tag -->

<link rel="stylesheet" href="/_bridgetown/static/index.NGPCTLGW.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" />
<script type="module">
  import 'https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js';
</script>
<script defer data-domain="karn18.github.io" src="https://analytics.karn.work/js/plausible.js"></script>
<script src="/_bridgetown/static/index.QYWZG4PN.js" defer></script>


  </head>
  <body class="post ">
    <nav>
  <ul>
    <li><a href="/">Home</a></li>
    
    
  </ul>
</nav>

    <main>
      <main data-controller="lightbox">
  <h1>Meilisearch vs Elasticsearch</h1>

  <p>ถ้าจะกล่าวถึง Full-Text Search ก็น่าจะพอได้ยิน <strong>Elasticsearch</strong> กันมาบ้าง และจากบทความ<a href="https://gorails.com/episodes/how-to-use-meilisearch-rails?autoplay=1">How to add Search in Rails using Meilisearch</a> ทำให้เราได้เจอกับ <a href="https://www.meilisearch.com/">Meilisearch</a> ซึ่งเป็นเครื่องมือที่ดีตัวหนึ่งในการทำ Full-Text Search เพียงแต่อาจจะต้องรอให้เติมโตจนพร้อมกว่านี้ คาดว่าอาจจะทำงานได้เทียบเคียงกับ <strong>Elasticsearch</strong> เลยทีเดียว</p>

<p>ในบทความนี้เราจะมาลองพัฒนาโปรแกรมขึ้นมา 2 ตัวสำหรับบันทึกข้อความด้วย <strong>Action Text</strong> และบันทึกข้อมูลลงในฐานข้อมูลผ่าน <strong>Action Storage</strong> โดยแต่ละตัวจะใช้ engine สำหรับ Full-Text Search ที่ต่างกัน เพื่อทดลองเปรียบเทียบตั้งแต่การติดตั้งใช้งานแต่ละตัว การเขียนโค้ด และผลลัพท์ที่ได้ในการใช้งาน</p>

<h2 id="การติดตั้ง">การติดตั้ง</h2>

<p>ในแง่ของการติดตั้งต้องบอกเลยว่า <strong>Meilisearch</strong> นั้นทำได้ง่ายกว่า <strong>Elasticsearch</strong> มากๆ แบบไม้ยมกต่อท้ายสัก 100 ตัว เพราะใช้คำสั่งแค่ 2 คำสั่งก็รัน service ขึ้นมาให้พร้อมใช้งานได้เลย ถ้าเทียบกับ <strong>Elasticsearch</strong> นี้ต้องใช้เวลานานอยู่พอสมควร แต่ทั้งนี้ก็ต้องยอมรับว่าตอนนี้ <strong>Meilisearch</strong> ยังมีฟังก์ชันฟีเจอร์ที่ต่างกับ <strong>Elasticsearch</strong> อยู่มากเลยทำให้ยังไม่มี dependency ใดๆ ที่ต้องมาผูกเข้าด้วยกัน</p>

<h2 id="การเขียนโค้ด">การเขียนโค้ด</h2>

<p>แน่นอนว่าการใช้งาน Full-Text Search จะต้องมีการเขียนโค้ดและกำหนดค่าต่างๆ ไม่ว่าจะเป็นการเชื่อมต่อไปยัง Server หรือระบุค่า Attributes หรือ Fields ที่ใช้สำหรับส่งไปเก็บบันทึก โดยโค้ดตัวอย่างที่แสดงด้านล่างจะเป็นการกำหนดค่าที่ได้จาก <code class="highlighter-rouge">content</code> ไปเก็บไว้ ซึ่งเราได้พยายามกำหนดค่าที่ง่ายและจำเป็นที่สุดในการใช้งานเท่านั้น</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># app/models/message.rb</span>
<span class="c1"># Meilisearch</span>
<span class="k">class</span> <span class="nc">Message</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="kp">include</span> <span class="no">MeiliSearch</span><span class="o">::</span><span class="no">Rails</span>

  <span class="n">has_rich_text</span> <span class="ss">:content</span>
  <span class="n">meilisearch</span> <span class="k">do</span>
    <span class="n">attribute</span> <span class="ss">:content</span>
    <span class="n">attributes_to_highlight</span> <span class="p">[</span><span class="s1">'*'</span><span class="p">]</span>
  <span class="k">end</span>  
<span class="k">end</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># app/models/message.rb</span>
<span class="c1"># Elasticsearch</span>
<span class="nb">require</span> <span class="s2">"elasticsearch/model"</span>

<span class="k">class</span> <span class="nc">Message</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="kp">include</span> <span class="no">Elasticsearch</span><span class="o">::</span><span class="no">Model</span>
  <span class="kp">include</span> <span class="no">Elasticsearch</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Callbacks</span>

  <span class="n">has_rich_text</span> <span class="ss">:content</span>
  <span class="n">settings</span> <span class="ss">index: </span><span class="p">{</span> <span class="ss">number_of_shards: </span><span class="mi">1</span> <span class="p">}</span> <span class="k">do</span>
    <span class="n">mappings</span> <span class="ss">dynamic: </span><span class="kp">true</span> <span class="k">do</span>
      <span class="n">indexes</span> <span class="ss">:content</span><span class="p">,</span> <span class="ss">type: :object</span> <span class="k">do</span>
        <span class="n">indexes</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">type: :long</span>
        <span class="n">indexes</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">type: :text</span>
        <span class="n">indexes</span> <span class="ss">:body</span><span class="p">,</span> <span class="ss">type: :text</span><span class="p">,</span> <span class="ss">analyzer: </span><span class="s1">'thai'</span>
        <span class="n">indexes</span> <span class="ss">:record_id</span><span class="p">,</span> <span class="ss">type: :long</span>
        <span class="n">indexes</span> <span class="ss">:record_type</span><span class="p">,</span> <span class="ss">type: :text</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">as_indexed_json</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">{})</span>
    <span class="n">as_json</span><span class="p">(</span><span class="ss">elastic: </span><span class="kp">true</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">as_json</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">{})</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="ss">:elastic</span><span class="p">,</span> <span class="kp">false</span><span class="p">)</span>
      <span class="k">super</span><span class="p">(</span><span class="ss">include: :content</span><span class="p">).</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">message</span><span class="o">|</span>
        <span class="n">message</span><span class="p">[</span><span class="s2">"content"</span><span class="p">][</span><span class="s2">"body"</span><span class="p">]</span> <span class="o">=</span> <span class="n">content</span><span class="p">.</span><span class="nf">to_plain_text</span>
      <span class="k">end</span>
    <span class="k">else</span>
      <span class="k">super</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h2 id="ทดสอบการใช้งาน">ทดสอบการใช้งาน</h2>

<p><img src="/images/posts/2022/meilisearch-vs-elasticsearch/messages.png" alt="" width="600px" />
<em>[Elasticsearch &amp; Meilisearch] Message ที่สร้างขึ้นมาทดสอบ</em></p>

<ul>
  <li>ค้นหาคำว่า <strong>api</strong></li>
</ul>

<p><img src="/images/posts/2022/meilisearch-vs-elasticsearch/elasticsearch-1.png" alt="" width="600px" />
<em>[Elasticsearch] ค้นหาคำว่า api</em></p>

<p><img src="/images/posts/2022/meilisearch-vs-elasticsearch/meilisearch-1.png" alt="" width="600px" />
<em>[Meilisearch] ค้นหาคำว่า api</em></p>

<ul>
  <li>ค้นหาคำว่า <strong>ไทย</strong></li>
</ul>

<p><img src="/images/posts/2022/meilisearch-vs-elasticsearch/elasticsearch-2.png" alt="" width="600px" />
<em>[Elasticsearch] ค้นหาคำว่า ไทย</em></p>

<p><img src="/images/posts/2022/meilisearch-vs-elasticsearch/meilisearch-2.png" alt="" width="600px" />
<em>[Meilisearch] ค้นหาคำว่า api</em></p>

<p>ในเวอร์ชันปัจจุบันของ <strong>Meilisearch</strong> [0.26] ยังไม่รองรับ tokenizer ที่เป็นภาษาไทยเลยทำให้ในตอนนี้ยังไม่สามารถตัดคำ และค้นหาคำที่เป็นภาษาไทยได้ แต่ถ้าเราใช้ภาษาอังกฤษก็ไม่ติดประเด็นอะไร</p>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://www.elastic.co/elasticsearch/">Elasticsearch</a></li>
  <li><a href="https://www.meilisearch.com/">Meilisearch</a></li>
</ul>

</main>

    </main>
  </body>
</html>
